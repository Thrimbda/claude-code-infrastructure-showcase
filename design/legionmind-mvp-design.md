# LegionMind MVP è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

LegionMind MVP æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è·¨ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿï¼Œä¸“æ³¨äºè§£å†³ Claude Code ä½¿ç”¨ä¸­çš„æ ¸å¿ƒç—›ç‚¹ï¼š**ä¼šè¯é‡ç½®åçš„ä¸Šä¸‹æ–‡ä¸¢å¤±**ã€‚

### è®¾è®¡åŸåˆ™

1. **Skill ä¼˜å…ˆ** - Skill æ˜¯æ ¸å¿ƒï¼ŒMCP æ˜¯è¾…åŠ©å·¥å…·ï¼ˆç”¨äºæ ¼å¼æ§åˆ¶å’Œ Schema æ ¡éªŒï¼‰
2. **äººç±»å¯è¯»** - æ‰€æœ‰è®°å½•ä½¿ç”¨ Markdown æ ¼å¼ï¼Œäººç±»å¯ä»¥ç›´æ¥é˜…è¯»å’Œç¼–è¾‘
3. **ç®€å•ä¼˜å…ˆ** - æš‚ä¸è€ƒè™‘å¤š Agent å¹¶å‘ï¼Œå…ˆè§£å†³å• Agent è·¨ä¼šè¯é—®é¢˜
4. **ç‹¬ç«‹è¿è¡Œ** - æš‚ä¸ä¸ç°æœ‰ç³»ç»Ÿé›†æˆï¼Œä½†å€Ÿé‰´å…¶è‰¯å¥½è®¾è®¡
5. **å®¹é”™è®¾è®¡** - äººç±»ç¼–è¾‘ç ´åæ ¼å¼æ—¶ï¼ŒAgent èƒ½è§£æè­¦å‘Šå¹¶è‡ªåŠ¨ä¿®å¤

### æ ¸å¿ƒä»·å€¼

- åœ¨ä»»æ„å·¥ä½œç›®å½•è§¦å‘ï¼Œå¼€å§‹è®°å½•ä¸Šä¸‹æ–‡
- Session é‡ç½®æˆ–åˆ‡æ¢ Agent æ—¶ï¼Œå¿«é€Ÿæ¢å¤å·¥ä½œçŠ¶æ€
- ä¿ç•™çš„è®°å½•äººç±»ä¹Ÿèƒ½çœ‹æ‡‚ï¼Œå¯ç”¨äº Review å’Œäº¤æ¥

---

## ç›®å½•ç»“æ„

### åŸºç¡€ç»“æ„

```
{working-directory}/
â””â”€â”€ .legion/
    â”œâ”€â”€ config.json                    # å…¨å±€é…ç½® + å½“å‰æ´»è·ƒä»»åŠ¡æŒ‡é’ˆ
    â””â”€â”€ tasks/
        â”œâ”€â”€ {task-id-1}/
        â”‚   â”œâ”€â”€ plan.md                # ä»»åŠ¡è®¡åˆ’ï¼ˆReview ç”¨ï¼‰
        â”‚   â”œâ”€â”€ context.md             # å·¥ä½œä¸Šä¸‹æ–‡ï¼ˆäº¤æ¥ç”¨ï¼‰
        â”‚   â””â”€â”€ tasks.md               # ä»»åŠ¡æ¸…å•ï¼ˆè¿›åº¦è·Ÿè¸ªï¼‰
        â”œâ”€â”€ {task-id-2}/
        â”‚   â”œâ”€â”€ plan.md
        â”‚   â”œâ”€â”€ context.md
        â”‚   â””â”€â”€ tasks.md
        â””â”€â”€ ...
```

### ç›®å½•è¯´æ˜

| è·¯å¾„ | ç”¨é€” | å¤‡æ³¨ |
|------|------|------|
| `.legion/` | LegionMind æ ¹ç›®å½• | æ”¾åœ¨å·¥ä½œç›®å½•ä¸‹ï¼Œæ¯ä¸ªé¡¹ç›®ç‹¬ç«‹ |
| `.legion/config.json` | å…¨å±€é…ç½® | åŒ…å«å½“å‰æ´»è·ƒä»»åŠ¡ã€å…¨å±€è®¾ç½® |
| `.legion/tasks/` | ä»»åŠ¡ç›®å½• | æ¯ä¸ªä»»åŠ¡ä¸€ä¸ªå­ç›®å½• |
| `.legion/tasks/{task-id}/` | å•ä¸ªä»»åŠ¡ | åŒ…å«ä¸‰æ–‡ä»¶ç»“æ„ |

### ä¸ç°æœ‰ Dev Docs çš„å…³ç³»

LegionMind ä»¥ `.legion/` ä½œä¸º**å”¯ä¸€æŒä¹…åŒ–æ¥æº**ï¼Œç”¨äºæ›¿ä»£æ—§çš„ `dev/active` ä¸‰æ–‡ä»¶æ¨¡å¼ã€‚  
MVP ä¸æä¾›è¿ç§»/å¯¼å…¥å‘½ä»¤ï¼›è‹¥é¡¹ç›®å†…å­˜åœ¨ `dev/active/`ï¼Œ`legion_init` åªç»™ä¸€æ¬¡æ€§æç¤ºï¼Œä½†ä¸ä¼šè‡ªåŠ¨å¯¼å…¥æˆ–å†™å…¥ã€‚

### ä»»åŠ¡å‘½åè§„èŒƒ

ä»»åŠ¡æ”¯æŒä¸­æ–‡ç­‰ä»»æ„è‡ªç„¶è¯­è¨€å‘½åï¼Œä½†**æ˜¾ç¤ºå**ä¸**ç›®å½•å**åˆ†ç¦»ï¼š

- **æ˜¾ç¤ºåï¼ˆtask nameï¼‰**ï¼šäººç±»å¯è¯»ï¼Œå¯åŒ…å«ä¸­æ–‡ã€ç©ºæ ¼ã€æ ‡ç‚¹ï¼›ç”¨äºä¸‰æ–‡ä»¶æ ‡é¢˜ä¸ UI å±•ç¤ºã€‚
- **ç›®å½•åï¼ˆtask idï¼‰**ï¼šç”± MCP è‡ªåŠ¨ç”Ÿæˆçš„ç¨³å®šæ ‡è¯†ï¼Œç”¨äºæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ã€‚

**task id ç”Ÿæˆè§„åˆ™**ï¼š
1. å¯¹æ˜¾ç¤ºååš slugifyï¼ˆå°å†™ã€ç©ºæ ¼/æ ‡ç‚¹è½¬ `-`ï¼Œå»é™¤éæ³•å­—ç¬¦ï¼‰ã€‚
2. è‹¥ slug ä¸ºç©ºæˆ–ä¸å·²å­˜åœ¨ä»»åŠ¡å†²çªï¼Œåˆ™ä½¿ç”¨ `task-{shortHash}`ã€‚

ç¤ºä¾‹ï¼š
- æ˜¾ç¤ºåï¼š`å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—` â†’ task idï¼š`shi-xian-yong-hu-ren-zheng-mo-kuai`ï¼ˆæˆ– `task-a1b2c3`ï¼‰
- æ˜¾ç¤ºåï¼š`Refactor DB layer` â†’ task idï¼š`refactor-db-layer`

---

## é…ç½®æ–‡ä»¶è®¾è®¡

### config.json

```json
{
  "$schema": "./config.schema.json",
  "version": "1.0.0",
  "currentTask": "refactor-db-layer",
  "settings": {
    "autoRemind": true,
    "remindBeforeReset": true
  },
  "tasks": [
    {
      "id": "refactor-db-layer",
      "name": "é‡æ„æ•°æ®åº“å±‚",
      "status": "active",
      "createdAt": "2025-12-12T10:00:00Z",
      "updatedAt": "2025-12-12T14:30:00Z"
    },
    {
      "id": "task-9f3a2b",
      "name": "æ€§èƒ½é—®é¢˜æ’æŸ¥ï¼ˆæ”¯ä»˜é“¾è·¯ï¼‰",
      "status": "paused",
      "createdAt": "2025-12-11T09:00:00Z",
      "updatedAt": "2025-12-11T18:00:00Z"
    }
  ]
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `version` | string | æ˜¯ | Schema ç‰ˆæœ¬å· |
| `currentTask` | string \| null | å¦ | å½“å‰æ´»è·ƒä»»åŠ¡ idï¼›`null` è¡¨ç¤ºå½“å‰æ— ä»»åŠ¡ |
| `settings.autoRemind` | boolean | æ˜¯ | Agent è¯»åˆ° `.legion/` æ—¶æ˜¯å¦è‡ªåŠ¨æé†’ |
| `settings.remindBeforeReset` | boolean | æ˜¯ | Session ç»“æŸå‰æ˜¯å¦æé†’ |
| `tasks` | array | æ˜¯ | ä»»åŠ¡åˆ—è¡¨ |
| `tasks[].id` | string | æ˜¯ | ä»»åŠ¡ idï¼ˆç›®å½•åï¼‰ |
| `tasks[].name` | string | æ˜¯ | ä»»åŠ¡æ˜¾ç¤ºåï¼ˆå¯ä¸­æ–‡ï¼‰ |
| `tasks[].status` | enum | æ˜¯ | `active` / `paused` / `completed` / `archived` |
| `tasks[].createdAt` | ISO8601 | æ˜¯ | åˆ›å»ºæ—¶é—´ |
| `tasks[].updatedAt` | ISO8601 | æ˜¯ | æœ€åæ›´æ–°æ—¶é—´ |

### ä»»åŠ¡çŠ¶æ€æµè½¬è§„åˆ™

- åŒä¸€æ—¶åˆ»æœ€å¤šä¸€ä¸ªä»»åŠ¡ä¸º `active`ï¼›å…¶ id å¿…é¡»ç­‰äº `currentTask`ã€‚
- `currentTask = null` æ—¶ï¼Œæ‰€æœ‰ä»»åŠ¡çŠ¶æ€ä¸å¾—ä¸º `active`ã€‚
- æ¨èçŠ¶æ€è½¬ç§»ï¼š
  - `active â†’ paused â†’ active`ï¼ˆåˆ‡æ¢ä»»åŠ¡æ—¶ï¼‰
  - `active â†’ completed â†’ archived`ï¼ˆéªŒæ”¶é€šè¿‡åå½’æ¡£ï¼‰
- `legion_switch_task` çš„é»˜è®¤è¡Œä¸ºï¼šå°†å½“å‰ `active` ä»»åŠ¡è®¾ä¸º `paused`ï¼Œç›®æ ‡ä»»åŠ¡è®¾ä¸º `active` å¹¶å†™å…¥ `currentTask`ã€‚

---

## ä¸‰æ–‡ä»¶ Schema è®¾è®¡

### æ–‡ä»¶å®šä½å¯¹æ¯”

| æ–‡ä»¶ | å®šä½ | ä¸»è¦å—ä¼— | æ›´æ–°é¢‘ç‡ | Schema ä¸¥æ ¼åº¦ |
|------|------|----------|----------|--------------|
| **plan.md** | ä»»åŠ¡è®¡åˆ’ï¼ŒReview ç”¨ | äººç±»/Agent å®¡é˜…è€… | ä½ï¼ˆè®¡åˆ’å˜æ›´æ—¶ï¼‰ | ä¸­ç­‰ |
| **context.md** | å·¥ä½œæ—¥å¿—ï¼Œäº¤æ¥ç”¨ | ä¸‹ä¸€ä¸ªæ¥æ‰‹çš„ Agent | é«˜ï¼ˆæ¯æ¬¡é‡è¦è¿›å±•ï¼‰ | ä¸­ç­‰ |
| **tasks.md** | è¿›åº¦è·Ÿè¸ªï¼Œå¯å‹¾é€‰ | äººç±»/Agent æ‰§è¡Œè€… | é«˜ï¼ˆå®Œæˆä»»åŠ¡æ—¶ï¼‰ | ä¸¥æ ¼ |

---

## plan.md è¯¦ç»†è®¾è®¡

### ç”¨é€”

- è®©äººç±»æˆ– Agent å¿«é€Ÿç†è§£ä»»åŠ¡å…¨è²Œ
- ç”¨äº Review å’Œå®¡æ‰¹
- è®°å½•å…³é”®å†³ç­–å’Œæ³¨æ„äº‹é¡¹

### Schema

```yaml
file: plan.md
purpose: "ä»»åŠ¡è®¡åˆ’ï¼Œç®€æ˜æ‰¼è¦ï¼Œç”¨äº Review"
update_frequency: "ä½ - ä»…åœ¨è®¡åˆ’å˜æ›´æ—¶æ›´æ–°"

sections:
  - name: "æ ‡é¢˜"
    format: "# {ä»»åŠ¡å}"
    required: true

  - name: "ç›®æ ‡"
    format: "## ç›®æ ‡"
    required: true
    description: "ä¸€å¥è¯è¯´æ¸…æ¥šè¦åšä»€ä¹ˆï¼Œä¸è¶…è¿‡ 2-3 å¥"

  - name: "è¦ç‚¹"
    format: "## è¦ç‚¹"
    required: true
    description: "å…³é”®çº¦æŸã€æŠ€æœ¯é€‰å‹ã€é£é™©ç‚¹ï¼Œä½¿ç”¨ bullet list"
    max_items: 7

  - name: "èŒƒå›´"
    format: "## èŒƒå›´"
    required: true
    description: "ä¼šæ”¹åŠ¨çš„æ–‡ä»¶/æ¨¡å—åˆ—è¡¨"

  - name: "é˜¶æ®µæ¦‚è§ˆ"
    format: "## é˜¶æ®µæ¦‚è§ˆ"
    required: true
    description: "å®æ–½é˜¶æ®µçš„ç®€è¦åˆ—è¡¨ï¼Œä½¿ç”¨æœ‰åºåˆ—è¡¨"

  - name: "å…ƒä¿¡æ¯"
    format: "---\n*åˆ›å»ºäº: {date} | æœ€åæ›´æ–°: {date}*"
    required: true
```

### å®Œæ•´ç¤ºä¾‹

```markdown
# å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—

## ç›®æ ‡

å®ç°åŸºäº JWT çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œæ”¯æŒç™»å½•ã€ç™»å‡ºã€token åˆ·æ–°ï¼Œé›†æˆç°æœ‰çš„ Keycloak ä½œä¸ºèº«ä»½æä¾›è€…ã€‚

## è¦ç‚¹

- **æŠ€æœ¯é€‰å‹**: JWT + RS256 ç®—æ³•ï¼Œæ”¯æŒå…¬é’¥éªŒè¯
- **å…³é”®çº¦æŸ**: å¿…é¡»å…¼å®¹ç°æœ‰ Keycloak é›†æˆ
- **å®‰å…¨è¦æ±‚**: Token è¿‡æœŸæ—¶é—´ 15 åˆ†é’Ÿï¼Œåˆ·æ–° token ä½¿ç”¨ httpOnly cookie
- **æ€§èƒ½ç›®æ ‡**: è®¤è¯æ¥å£ p99 < 100ms
- **é£é™©ç‚¹**: å¹¶å‘åˆ·æ–° token å¯èƒ½å¯¼è‡´ç«æ€æ¡ä»¶

## èŒƒå›´

å°†æ”¹åŠ¨ä»¥ä¸‹æ–‡ä»¶/æ¨¡å—ï¼š

- `src/auth/` - æ–°å»ºè®¤è¯æ¨¡å—
  - `jwt.ts` - JWT å·¥å…·
  - `middleware.ts` - è®¤è¯ä¸­é—´ä»¶
  - `routes.ts` - è®¤è¯è·¯ç”±
- `src/config/` - æ·»åŠ  JWT é…ç½®
- `prisma/schema.prisma` - æ·»åŠ  RefreshToken æ¨¡å‹
- `tests/auth/` - è®¤è¯æµ‹è¯•

## é˜¶æ®µæ¦‚è§ˆ

1. **åŸºç¡€è®¾æ–½** - JWT å·¥å…·ã€å¯†é’¥ç®¡ç†ã€åŸºç¡€é…ç½®
2. **æ ¸å¿ƒå®ç°** - ç™»å½•ã€ç™»å‡ºã€token åˆ·æ–°æ¥å£
3. **å®‰å…¨åŠ å›º** - é»‘åå•ã€rate limitingã€é”™è¯¯è¿½è¸ª
4. **æµ‹è¯•éªŒè¯** - å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•

---

*åˆ›å»ºäº: 2025-12-12 | æœ€åæ›´æ–°: 2025-12-12*
```

### æ ¼å¼è§„åˆ™

1. **ç›®æ ‡éƒ¨åˆ†**ï¼šä¸è¶…è¿‡ 3 å¥è¯
2. **è¦ç‚¹éƒ¨åˆ†**ï¼šä¸è¶…è¿‡ 7 ä¸ªè¦ç‚¹ï¼Œæ¯ä¸ªè¦ç‚¹ä½¿ç”¨ `**å…³é”®è¯**: æè¿°` æ ¼å¼
3. **èŒƒå›´éƒ¨åˆ†**ï¼šä½¿ç”¨æ ‘å½¢ç»“æ„å±•ç¤ºæ–‡ä»¶ï¼ŒåŒ…å«ç®€è¦è¯´æ˜
4. **é˜¶æ®µæ¦‚è§ˆ**ï¼šä½¿ç”¨æœ‰åºåˆ—è¡¨ï¼Œæ¯é¡¹ `**é˜¶æ®µå** - ç®€è¦æè¿°` æ ¼å¼

---

## context.md è¯¦ç»†è®¾è®¡

### ç”¨é€”

- å·¥ä½œæ—¥å¿—ï¼Œè®°å½•è¿›å±•å’Œå†³ç­–
- äº¤æ¥æ–‡æ¡£ï¼Œè®©ä¸‹ä¸€ä¸ª Agent å¿«é€Ÿä¸Šæ‰‹
- ä¿å­˜éšæ€§çŸ¥è¯†ï¼ˆä¸ºä»€ä¹ˆè¿™æ ·åšã€è¸©è¿‡ä»€ä¹ˆå‘ï¼‰

### Schema

```yaml
file: context.md
purpose: "å·¥ä½œä¸Šä¸‹æ–‡ï¼Œäº¤æ¥ç”¨"
update_frequency: "é«˜ - æ¯æ¬¡é‡è¦è¿›å±•åæ›´æ–°"

sections:
  - name: "æ ‡é¢˜"
    format: "# {ä»»åŠ¡å} - ä¸Šä¸‹æ–‡"
    required: true

  - name: "ä¼šè¯è¿›å±•"
    format: "## ä¼šè¯è¿›å±• ({date})"
    required: true
    subsections:
      - name: "å·²å®Œæˆ"
        format: "### âœ… å·²å®Œæˆ"
        required: true
        description: "æœ¬æ¬¡ä¼šè¯å®Œæˆçš„å·¥ä½œ"
      - name: "è¿›è¡Œä¸­"
        format: "### ğŸŸ¡ è¿›è¡Œä¸­"
        required: true
        description: "å½“å‰æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼ŒåŒ…å«æ–‡ä»¶è·¯å¾„"
      - name: "é˜»å¡/å¾…å®š"
        format: "### âš ï¸ é˜»å¡/å¾…å®š"
        required: false
        description: "é˜»å¡åŸå› æˆ–å¾…ç¡®è®¤äº‹é¡¹"

  - name: "å…³é”®æ–‡ä»¶"
    format: "## å…³é”®æ–‡ä»¶"
    required: true
    description: "æ¯ä¸ªæ–‡ä»¶åŒ…å«è·¯å¾„ã€ä½œç”¨ã€çŠ¶æ€ã€æ³¨æ„äº‹é¡¹"
    item_format: |
      **`{file_path}`** [{status}]
      - ä½œç”¨ï¼š{purpose}
      - æ³¨æ„ï¼š{notes}

  - name: "å…³é”®å†³ç­–"
    format: "## å…³é”®å†³ç­–"
    required: true
    description: "ä½¿ç”¨è¡¨æ ¼è®°å½•å†³ç­–"
    table_columns:
      - "å†³ç­–"
      - "åŸå› "
      - "æ›¿ä»£æ–¹æ¡ˆ"
      - "æ—¥æœŸ"

  - name: "æŠ€æœ¯çº¦æŸ"
    format: "## æŠ€æœ¯çº¦æŸ"
    required: false
    description: "å‘ç°çš„æŠ€æœ¯é™åˆ¶å’Œçº¦æŸæ¡ä»¶"

  - name: "ç›¸å…³é“¾æ¥"
    format: "## ç›¸å…³é“¾æ¥"
    required: false
    description: "è®¾è®¡æ–‡æ¡£ã€API è§„èŒƒã€å‚è€ƒå®ç°ç­‰"

  - name: "å¿«é€Ÿäº¤æ¥"
    format: "## å¿«é€Ÿäº¤æ¥"
    required: true
    description: "ä¸‹ä¸€æ­¥ä»å“ªå¼€å§‹ã€æ³¨æ„ä»€ä¹ˆ"
    subsections:
      - name: "ç»§ç»­æ­¥éª¤"
        format: "**ä¸‹æ¬¡ç»§ç»­ä»è¿™é‡Œå¼€å§‹ï¼š**"
        required: true
      - name: "æ³¨æ„äº‹é¡¹"
        format: "**æ³¨æ„äº‹é¡¹ï¼š**"
        required: true

  - name: "å…ƒä¿¡æ¯"
    format: "---\n*æœ€åæ›´æ–°: {datetime} by {author}*"
    required: true
```

### å®Œæ•´ç¤ºä¾‹

```markdown
# å®ç°ç”¨æˆ·è®¤è¯æ¨¡å— - ä¸Šä¸‹æ–‡

## ä¼šè¯è¿›å±• (2025-12-12)

### âœ… å·²å®Œæˆ

- åˆ›å»ºäº† JWT å·¥å…·æ¨¡å— (`src/auth/jwt.ts`)
  - å®ç°äº† `generateToken()` å’Œ `verifyToken()`
  - ä½¿ç”¨ RS256 ç®—æ³•ï¼Œå¯†é’¥ä»ç¯å¢ƒå˜é‡è¯»å–
- åˆ›å»ºäº†è®¤è¯ä¸­é—´ä»¶ (`src/middleware/auth.ts`)
  - ä» Authorization header æå– token
  - éªŒè¯å¤±è´¥è¿”å› 401
- å®ç°äº†ç™»å½•æ¥å£ (`POST /auth/login`)
  - éªŒè¯ç”¨æˆ·å‡­è¯ï¼ˆå¯¹æ¥ Keycloakï¼‰
  - è¿”å› access_token å’Œ refresh_token
- æ·»åŠ äº†åŸºç¡€å•å…ƒæµ‹è¯•
  - jwt.test.ts: 10 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå…¨éƒ¨é€šè¿‡

### ğŸŸ¡ è¿›è¡Œä¸­

- å®ç° token åˆ·æ–°é€»è¾‘
  - æ–‡ä»¶: `src/auth/routes.ts`
  - æ–¹æ³•: `POST /auth/refresh`
  - å½“å‰çŠ¶æ€: æ¡†æ¶å·²æ­å»ºï¼Œæ ¸å¿ƒé€»è¾‘å¾…å®ç°

### âš ï¸ é˜»å¡/å¾…å®š

- éœ€è¦ç¡®è®¤ï¼šåˆ·æ–° token çš„è¿‡æœŸæ—¶é—´è®¾ä¸ºå¤šä¹…ï¼Ÿï¼ˆå»ºè®® 7 å¤©ï¼‰
- å¾…å®šï¼šæ˜¯å¦éœ€è¦æ”¯æŒå¤šè®¾å¤‡åŒæ—¶ç™»å½•ï¼Ÿ

---

## å…³é”®æ–‡ä»¶

**`src/auth/jwt.ts`** [å·²å®Œæˆ]
- ä½œç”¨ï¼šJWT ç”Ÿæˆå’ŒéªŒè¯å·¥å…·
- æ³¨æ„ï¼šä½¿ç”¨ RS256 ç®—æ³•ï¼Œç§é’¥åœ¨ `JWT_PRIVATE_KEY` ç¯å¢ƒå˜é‡

**`src/auth/routes.ts`** [è¿›è¡Œä¸­]
- ä½œç”¨ï¼šè®¤è¯ç›¸å…³çš„ API è·¯ç”±
- æ³¨æ„ï¼š`/refresh` æ¥å£éœ€è¦æ£€æŸ¥ token é»‘åå•

**`src/middleware/auth.ts`** [å·²å®Œæˆ]
- ä½œç”¨ï¼šè®¤è¯ä¸­é—´ä»¶ï¼Œä¿æŠ¤éœ€è¦ç™»å½•çš„è·¯ç”±
- æ³¨æ„ï¼šé”™è¯¯å·²é›†æˆ Sentry ä¸ŠæŠ¥

**`prisma/schema.prisma`** [å¾…ä¿®æ”¹]
- ä½œç”¨ï¼šæ•°æ®åº“æ¨¡å‹å®šä¹‰
- æ³¨æ„ï¼šéœ€è¦æ·»åŠ  RefreshToken æ¨¡å‹

---

## å…³é”®å†³ç­–

| å†³ç­– | åŸå›  | æ›¿ä»£æ–¹æ¡ˆ | æ—¥æœŸ |
|------|------|----------|------|
| ä½¿ç”¨ JWT è€Œé Session | éœ€è¦æ”¯æŒç§»åŠ¨ç«¯å’Œè·¨åŸŸåœºæ™¯ | Session + Redis | 2025-12-12 |
| é€‰æ‹© RS256 ç®—æ³• | æ”¯æŒå…¬é’¥éªŒè¯ï¼Œä¾¿äºå¾®æœåŠ¡æ¶æ„ | HS256ï¼ˆæ›´ç®€å•ä½†éœ€å…±äº«å¯†é’¥ï¼‰ | 2025-12-12 |
| Refresh token å­˜æ•°æ®åº“ | æ”¯æŒä¸»åŠ¨æ’¤é”€å’Œå¤šè®¾å¤‡ç®¡ç† | å­˜ Redisï¼ˆæ›´å¿«ä½†é‡å¯ä¸¢å¤±ï¼‰ | 2025-12-12 |
| Access token 15åˆ†é’Ÿè¿‡æœŸ | å¹³è¡¡å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒ | 1å°æ—¶ï¼ˆå®‰å…¨æ€§è¾ƒä½ï¼‰ | 2025-12-12 |

---

## æŠ€æœ¯çº¦æŸ

- **Keycloak é›†æˆ**ï¼šå¿…é¡»ä½¿ç”¨ç°æœ‰çš„ Keycloak ä½œä¸ºèº«ä»½éªŒè¯åç«¯ï¼Œä¸èƒ½è‡ªå»ºç”¨æˆ·å¯†ç å­˜å‚¨
- **Cookie é™åˆ¶**ï¼šRefresh token å¿…é¡»ä½¿ç”¨ httpOnly + Secure + SameSite=Strict
- **ç¯å¢ƒå˜é‡**ï¼šæ‰€æœ‰å¯†é’¥å¿…é¡»ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œä¸èƒ½ç¡¬ç¼–ç 
- **é”™è¯¯è¿½è¸ª**ï¼šæ‰€æœ‰è®¤è¯é”™è¯¯å¿…é¡»ä¸ŠæŠ¥åˆ° Sentry

---

## ç›¸å…³é“¾æ¥

- è®¾è®¡æ–‡æ¡£: [docs/auth-design.md](../docs/auth-design.md)
- API è§„èŒƒ: [docs/api/auth.yaml](../docs/api/auth.yaml)
- Keycloak æ–‡æ¡£: https://www.keycloak.org/docs/latest/
- JWT æœ€ä½³å®è·µ: https://datatracker.ietf.org/doc/html/rfc7519

---

## å¿«é€Ÿäº¤æ¥

**ä¸‹æ¬¡ç»§ç»­ä»è¿™é‡Œå¼€å§‹ï¼š**

1. æ‰“å¼€ `src/auth/routes.ts`
2. æ‰¾åˆ° `POST /auth/refresh` è·¯ç”±
3. å®ç° `refreshToken()` æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼š
   - ä» cookie ä¸­è¯»å– refresh_token
   - éªŒè¯ token ç­¾å
   - æ£€æŸ¥æ˜¯å¦åœ¨é»‘åå•ä¸­
   - ç”Ÿæˆæ–°çš„ access_token
   - ï¼ˆå¯é€‰ï¼‰è½®æ¢ refresh_token
4. æ·»åŠ  RefreshToken æ¨¡å‹åˆ° Prisma schema

**æ³¨æ„äº‹é¡¹ï¼š**

- åˆ·æ–° token æ—¶è¦æ£€æŸ¥é»‘åå•ï¼ˆå°šæœªå®ç°ï¼‰
- å¹¶å‘åˆ·æ–°å¯èƒ½å¯¼è‡´ç«æ€æ¡ä»¶ï¼Œè€ƒè™‘ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡
- è®°å¾—åŒæ­¥æ›´æ–° tasks.md çš„è¿›åº¦

---

*æœ€åæ›´æ–°: 2025-12-12 14:30 by Claude*
```

### æ ¼å¼è§„åˆ™

1. **ä¼šè¯è¿›å±•**ï¼šæ¯æ¬¡ä¼šè¯å¼€å§‹æ—¶åˆ›å»ºæ–°çš„æ—¥æœŸæ ‡é¢˜ï¼Œä¿ç•™å†å²è¿›å±•ï¼ˆå¯é€‰æ‹©æ€§å½’æ¡£æ—§è¿›å±•ï¼‰
2. **å…³é”®æ–‡ä»¶**ï¼šæ¯ä¸ªæ–‡ä»¶ä½¿ç”¨ `**\`path\`** [çŠ¶æ€]` æ ¼å¼ï¼ŒçŠ¶æ€å¯é€‰ï¼š`å·²å®Œæˆ` / `è¿›è¡Œä¸­` / `å¾…ä¿®æ”¹` / `å·²åˆ é™¤`
3. **å…³é”®å†³ç­–**ï¼šå¿…é¡»ä½¿ç”¨è¡¨æ ¼æ ¼å¼ï¼ŒåŒ…å«æ›¿ä»£æ–¹æ¡ˆåˆ—ï¼ˆå¸®åŠ©ç†è§£ä¸ºä»€ä¹ˆè¿™æ ·é€‰æ‹©ï¼‰
4. **å¿«é€Ÿäº¤æ¥**ï¼šå¿…é¡»åŒ…å«å…·ä½“çš„æ–‡ä»¶è·¯å¾„å’Œæ­¥éª¤ç¼–å·

---

## tasks.md è¯¦ç»†è®¾è®¡

### ç”¨é€”

- è¿›åº¦è·Ÿè¸ªï¼Œå¯è§†åŒ–å®ŒæˆçŠ¶æ€
- éªŒæ”¶æ ‡å‡†è®°å½•ï¼Œç¡®ä¿ä»»åŠ¡è´¨é‡
- å‘ç°æ–°ä»»åŠ¡æ—¶çš„è®°å½•ç‚¹

### Schema

```yaml
file: tasks.md
purpose: "ä»»åŠ¡æ¸…å•ï¼Œä¸¥æ ¼æ ¼å¼ï¼Œè¿›åº¦è·Ÿè¸ª"
update_frequency: "é«˜ - æ¯å®Œæˆä¸€ä¸ªä»»åŠ¡ç«‹å³æ›´æ–°"

sections:
  - name: "æ ‡é¢˜"
    format: "# {ä»»åŠ¡å} - ä»»åŠ¡æ¸…å•"
    required: true

  - name: "å¿«é€Ÿæ¢å¤"
    format: "## å¿«é€Ÿæ¢å¤"
    required: true
    fields:
      - name: "å½“å‰é˜¶æ®µ"
        format: "**å½“å‰é˜¶æ®µ**: {phase_name}"
        required: true
      - name: "å½“å‰ä»»åŠ¡"
        format: "**å½“å‰ä»»åŠ¡**: {task_description}"
        required: true
      - name: "è¿›åº¦"
        format: "**è¿›åº¦**: {completed}/{total} ä»»åŠ¡å®Œæˆ"
        required: true

  - name: "é˜¶æ®µ"
    format: "## {phase_name} {status_emoji} {status_text}"
    required: true
    repeatable: true
    status_options:
      - emoji: "âœ…"
        text: "COMPLETE"
      - emoji: "ğŸŸ¡"
        text: "IN PROGRESS"
      - emoji: "â³"
        text: "NOT STARTED"

  - name: "ä»»åŠ¡é¡¹"
    format: "- [{checked}] {description} | {acceptance_criteria}"
    required: true
    within: "é˜¶æ®µ"
    fields:
      - name: "checked"
        type: "checkbox"
        values: ["x", " "]
      - name: "description"
        type: "string"
        required: true
      - name: "acceptance_criteria"
        type: "string"
        required: true
        prefix: "éªŒæ”¶: "
    current_marker: "â† CURRENT"

  - name: "å‘ç°çš„æ–°ä»»åŠ¡"
    format: "## å‘ç°çš„æ–°ä»»åŠ¡"
    required: false
    description: "å®æ–½è¿‡ç¨‹ä¸­å‘ç°çš„é¢å¤–ä»»åŠ¡"
    item_format: "- [ ] {description} | æ¥æº: {source}"

  - name: "å…ƒä¿¡æ¯"
    format: "---\n*æœ€åæ›´æ–°: {datetime}*"
    required: true
```

### å®Œæ•´ç¤ºä¾‹

```markdown
# å®ç°ç”¨æˆ·è®¤è¯æ¨¡å— - ä»»åŠ¡æ¸…å•

## å¿«é€Ÿæ¢å¤

**å½“å‰é˜¶æ®µ**: é˜¶æ®µ 2 - æ ¸å¿ƒå®ç°
**å½“å‰ä»»åŠ¡**: å®ç° token åˆ·æ–°é€»è¾‘
**è¿›åº¦**: 5/12 ä»»åŠ¡å®Œæˆ

---

## é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ âœ… COMPLETE

- [x] åˆ›å»º JWT å·¥å…·æ¨¡å— | éªŒæ”¶: `jwt.ts` åŒ…å« `generateToken()` å’Œ `verifyToken()` æ–¹æ³•
- [x] é…ç½®å¯†é’¥ç®¡ç† | éªŒæ”¶: ä» `JWT_PRIVATE_KEY` å’Œ `JWT_PUBLIC_KEY` ç¯å¢ƒå˜é‡è¯»å–
- [x] åˆ›å»ºè®¤è¯ä¸­é—´ä»¶ | éªŒæ”¶: ä¸­é—´ä»¶èƒ½æ­£ç¡®è§£æå’ŒéªŒè¯ Bearer token
- [x] æ·»åŠ åŸºç¡€å•å…ƒæµ‹è¯• | éªŒæ”¶: jwt.test.ts æµ‹è¯•è¦†ç›– sign/verifyï¼Œå…¨éƒ¨é€šè¿‡

---

## é˜¶æ®µ 2: æ ¸å¿ƒå®ç° ğŸŸ¡ IN PROGRESS

- [x] å®ç°ç™»å½•æ¥å£ | éªŒæ”¶: `POST /auth/login` è¿”å› access_token å’Œ refresh_token
- [ ] å®ç° token åˆ·æ–°é€»è¾‘ | éªŒæ”¶: `POST /auth/refresh` æ­£ç¡®ç”Ÿæˆæ–° token â† CURRENT
- [ ] æ·»åŠ  RefreshToken æ•°æ®æ¨¡å‹ | éªŒæ”¶: Prisma schema åŒ…å«æ¨¡å‹ï¼Œmigration æˆåŠŸ
- [ ] å®ç°ç™»å‡ºæ¥å£ | éªŒæ”¶: `POST /auth/logout` å°† token åŠ å…¥é»‘åå•
- [ ] æ·»åŠ  token é»‘åå•æœºåˆ¶ | éªŒæ”¶: é»‘åå•ä¸­çš„ token æ— æ³•åˆ·æ–°

---

## é˜¶æ®µ 3: å®‰å…¨åŠ å›º â³ NOT STARTED

- [ ] é›†æˆ Sentry é”™è¯¯è¿½è¸ª | éªŒæ”¶: è®¤è¯é”™è¯¯è‡ªåŠ¨ä¸ŠæŠ¥åˆ° Sentry
- [ ] æ·»åŠ  rate limiting | éªŒæ”¶: ç™»å½•æ¥å£é™åˆ¶ 5æ¬¡/åˆ†é’Ÿ/IP
- [ ] æ·»åŠ è¯·æ±‚æ—¥å¿— | éªŒæ”¶: æ‰€æœ‰è®¤è¯è¯·æ±‚è®°å½•åˆ°æ—¥å¿—ï¼ˆè„±æ•ï¼‰

---

## é˜¶æ®µ 4: æµ‹è¯•éªŒè¯ â³ NOT STARTED

- [ ] ç«¯åˆ°ç«¯ç™»å½•æµç¨‹æµ‹è¯• | éªŒæ”¶: å®Œæ•´æµç¨‹ï¼ˆç™»å½•â†’è®¿é—®â†’åˆ·æ–°â†’ç™»å‡ºï¼‰é€šè¿‡
- [ ] token è¿‡æœŸåœºæ™¯æµ‹è¯• | éªŒæ”¶: è¿‡æœŸåæ­£ç¡®è¿”å› 401ï¼Œåˆ·æ–°åæ¢å¤
- [ ] å¹¶å‘åˆ·æ–°æµ‹è¯• | éªŒæ”¶: å¤šä¸ªå¹¶å‘åˆ·æ–°è¯·æ±‚æ— ç«æ€æ¡ä»¶
- [ ] æ€§èƒ½æµ‹è¯• | éªŒæ”¶: è®¤è¯æ¥å£ p99 < 100ms

---

## å‘ç°çš„æ–°ä»»åŠ¡

- [ ] æ”¯æŒå¤šè®¾å¤‡ç™»å½•ç®¡ç† | æ¥æº: äº§å“éœ€æ±‚è®¨è®º
- [ ] æ·»åŠ ç™»å½•å†å²è®°å½• | æ¥æº: å®‰å…¨å®¡æŸ¥å»ºè®®
- [ ] å®ç°"è®°ä½æˆ‘"åŠŸèƒ½ | æ¥æº: ç”¨æˆ·åé¦ˆ

---

*æœ€åæ›´æ–°: 2025-12-12 14:30*
```

### æ ¼å¼è§„åˆ™

1. **å¿«é€Ÿæ¢å¤**ï¼šå¿…é¡»åŒ…å«ä¸‰ä¸ªå­—æ®µï¼Œè¿›åº¦ä½¿ç”¨ `X/Y` æ ¼å¼
2. **é˜¶æ®µæ ‡é¢˜**ï¼šæ ¼å¼ä¸º `## é˜¶æ®µ N: {åç§°} {emoji} {çŠ¶æ€}`
3. **ä»»åŠ¡é¡¹**ï¼šæ ¼å¼ä¸º `- [x/ ] {æè¿°} | éªŒæ”¶: {æ ‡å‡†}`
4. **å½“å‰ä»»åŠ¡**ï¼šä½¿ç”¨ `â† CURRENT` æ ‡è®°
5. **å‘ç°çš„æ–°ä»»åŠ¡**ï¼šå¿…é¡»æ ‡æ³¨æ¥æº

### çŠ¶æ€è§„åˆ™

| é˜¶æ®µçŠ¶æ€ | æ¡ä»¶ | æ˜¾ç¤º |
|----------|------|------|
| COMPLETE | æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆ | `âœ… COMPLETE` |
| IN PROGRESS | æœ‰ä»»åŠ¡è¿›è¡Œä¸­ | `ğŸŸ¡ IN PROGRESS` |
| NOT STARTED | æ— ä»»åŠ¡å¼€å§‹ | `â³ NOT STARTED` |

---

## MCP Server è®¾è®¡

### æ¦‚è¿°

LegionMind MCP Server æä¾›å·¥å…·å‡½æ•°ï¼Œç”¨äºï¼š
1. å¼ºåˆ¶ Schema æ ¡éªŒ
2. æ ‡å‡†åŒ–æ–‡ä»¶è¯»å†™
3. è‡ªåŠ¨å¤„ç†æ ¼å¼é”™è¯¯

### å·¥å…·åˆ—è¡¨

#### 1. åˆå§‹åŒ–å·¥å…·

##### `legion_init`

åˆå§‹åŒ– .legion ç›®å½•ç»“æ„ã€‚

```typescript
interface LegionInitParams {
  workingDirectory?: string;  // é»˜è®¤: å½“å‰å·¥ä½œç›®å½•
}

interface LegionInitResult {
  success: boolean;
  path: string;              // .legion ç›®å½•è·¯å¾„
  message: string;
}
```

**è¡Œä¸º**ï¼š
- åˆ›å»º `.legion/` ç›®å½•
- åˆ›å»º `.legion/config.json` åˆå§‹é…ç½®
- åˆ›å»º `.legion/tasks/` ç›®å½•
- å¦‚æœå·²å­˜åœ¨ï¼Œè¿”å›è­¦å‘Šä½†ä¸è¦†ç›–
- è‹¥æ£€æµ‹åˆ° `dev/active/` ç›®å½•å­˜åœ¨ï¼Œè¿”å›ä¸€æ¬¡æ€§æç¤ºï¼šLegionMind å°†ä½¿ç”¨ `.legion/` ä½œä¸ºå”¯ä¸€æ¥æºï¼ˆä¸è‡ªåŠ¨è¿ç§»ï¼‰

##### `legion_create_task`

åˆ›å»ºæ–°ä»»åŠ¡ã€‚

```typescript
interface LegionCreateTaskParams {
  name: string;              // ä»»åŠ¡æ˜¾ç¤ºåï¼ˆå…è®¸ä¸­æ–‡ï¼‰
  goal: string;              // ä»»åŠ¡ç›®æ ‡ï¼ˆç”¨äº plan.mdï¼‰
  points?: string[];         // è¦ç‚¹åˆ—è¡¨ï¼ˆç”¨äº plan.mdï¼‰
  scope?: string[];          // èŒƒå›´åˆ—è¡¨ï¼ˆç”¨äº plan.mdï¼‰
  phases?: Phase[];          // é˜¶æ®µåˆ—è¡¨ï¼ˆç”¨äº plan.md å’Œ tasks.mdï¼‰
}

interface Phase {
  name: string;
  tasks: Task[];
}

interface Task {
  description: string;
  acceptance: string;
}

interface LegionCreateTaskResult {
  success: boolean;
  taskId: string;            // è‡ªåŠ¨ç”Ÿæˆçš„ä»»åŠ¡ idï¼ˆç›®å½•åï¼‰
  taskPath: string;          // ä»»åŠ¡ç›®å½•è·¯å¾„
  files: string[];           // åˆ›å»ºçš„æ–‡ä»¶åˆ—è¡¨
  message: string;
}
```

**è¡Œä¸º**ï¼š
- ç”Ÿæˆç¨³å®šçš„ `taskId`ï¼ˆè§â€œä»»åŠ¡å‘½åè§„èŒƒâ€ï¼‰
- åˆ›å»º `.legion/tasks/{taskId}/` ç›®å½•
- ç”Ÿæˆ plan.mdã€context.mdã€tasks.md åˆå§‹å†…å®¹
- æ›´æ–° config.json çš„ä»»åŠ¡åˆ—è¡¨
- è®¾ç½®ä¸ºå½“å‰æ´»è·ƒä»»åŠ¡ï¼ˆå¿…è¦æ—¶æš‚åœä¸Šä¸€ä¸ª activeï¼‰

#### 2. çŠ¶æ€æŸ¥è¯¢å·¥å…·

##### `legion_get_status`

è·å–å½“å‰çŠ¶æ€æ‘˜è¦ã€‚

```typescript
interface LegionGetStatusParams {
  taskId?: string;           // æŒ‡å®šä»»åŠ¡ idï¼Œé»˜è®¤ä¸º currentTask
}

interface LegionGetStatusResult {
  currentTask: string | null;
  taskStatus: {
    phase: string;
    currentTaskDescription: string;
    progress: {
      completed: number;
      total: number;
    };
  } | null;
  recentProgress: string[];  // æœ€è¿‘å®Œæˆçš„ 3 é¡¹
  blockers: string[];        // å½“å‰é˜»å¡é¡¹
}
```

##### `legion_list_tasks`

åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡ã€‚

```typescript
interface LegionListTasksResult {
  tasks: {
    id: string;
    name: string;
    status: 'active' | 'paused' | 'completed' | 'archived';
    progress: string;        // å¦‚ "5/12"
    updatedAt: string;
  }[];
  currentTask: string | null;
}
```

##### `legion_read_context`

è¯»å–å®Œæ•´ä¸Šä¸‹æ–‡ã€‚

```typescript
interface LegionReadContextParams {
  taskId?: string;           // æŒ‡å®šä»»åŠ¡ idï¼Œé»˜è®¤ä¸º currentTask
  section?: 'all' | 'progress' | 'decisions' | 'files' | 'handoff';
}

interface LegionReadContextResult {
  taskId: string;
  taskName: string;          // æ˜¾ç¤ºå
  content: string;           // Markdown å†…å®¹
  parsed: {                  // è§£æåçš„ç»“æ„åŒ–æ•°æ®
    sessionProgress: {
      completed: string[];
      inProgress: string[];
      blocked: string[];
    };
    keyFiles: KeyFile[];
    decisions: Decision[];
    handoff: {
      nextSteps: string[];
      notes: string[];
    };
  };
  warnings: string[];        // è§£æè­¦å‘Šï¼ˆæ ¼å¼é—®é¢˜ï¼‰
}
```

#### 3. æ›´æ–°å·¥å…·

##### `legion_update_plan`

æ›´æ–° plan.mdã€‚

```typescript
interface LegionUpdatePlanParams {
  taskId?: string;
  goal?: string;
  points?: string[];
  scope?: string[];
  phases?: string[];
}

interface LegionUpdatePlanResult {
  success: boolean;
  warnings: string[];        // Schema æ ¡éªŒè­¦å‘Š
  autoFixed: string[];       // è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜
}
```

##### `legion_update_context`

æ›´æ–° context.mdã€‚

```typescript
interface LegionUpdateContextParams {
  taskId?: string;

  // æ›´æ–°ä¼šè¯è¿›å±•
  progress?: {
    completed?: string[];    // æ·»åŠ åˆ°å·²å®Œæˆ
    inProgress?: string[];   // è®¾ç½®è¿›è¡Œä¸­ï¼ˆæ›¿æ¢ï¼‰
    blocked?: string[];      // è®¾ç½®é˜»å¡é¡¹ï¼ˆæ›¿æ¢ï¼‰
  };

  // æ·»åŠ å…³é”®æ–‡ä»¶
  addFile?: {
    path: string;
    purpose: string;
    status: 'completed' | 'in_progress' | 'pending' | 'deleted';
    notes?: string;
  };

  // æ·»åŠ å†³ç­–
  addDecision?: {
    decision: string;
    reason: string;
    alternatives?: string;
    date?: string;           // é»˜è®¤ä»Šå¤©
  };

  // æ·»åŠ æŠ€æœ¯çº¦æŸ
  addConstraint?: string;

  // æ›´æ–°å¿«é€Ÿäº¤æ¥
  handoff?: {
    nextSteps: string[];
    notes: string[];
  };
}

interface LegionUpdateContextResult {
  success: boolean;
  warnings: string[];
  autoFixed: string[];
}
```

##### `legion_update_tasks`

æ›´æ–° tasks.mdã€‚

```typescript
interface LegionUpdateTasksParams {
  taskId?: string;

  // å®Œæˆä»»åŠ¡
  completeTask?: {
    phase: number | string;          // é˜¶æ®µç´¢å¼•æˆ–åç§°
    taskIndex?: number;              // ä»»åŠ¡ç´¢å¼•ï¼ˆå¯é€‰ï¼Œæ˜“æ¼‚ç§»ï¼‰
    taskDescription?: string;        // ä»»åŠ¡æè¿°ï¼ˆä¼˜å…ˆç”¨äºç¨³å®šå®šä½ï¼‰
  };

  // è®¾ç½®å½“å‰ä»»åŠ¡
  setCurrentTask?: {
    phase: number | string;
    taskIndex?: number;
    taskDescription?: string;
  };

  // æ·»åŠ æ–°ä»»åŠ¡åˆ°é˜¶æ®µ
  addTask?: {
    phase: number | string;
    description: string;
    acceptance: string;
  };

  // æ·»åŠ å‘ç°çš„æ–°ä»»åŠ¡
  addDiscoveredTask?: {
    description: string;
    source: string;
  };

  // æ›´æ–°é˜¶æ®µçŠ¶æ€ï¼ˆé€šå¸¸è‡ªåŠ¨è®¡ç®—ï¼‰
  updatePhaseStatus?: {
    phase: number | string;
    status: 'not_started' | 'in_progress' | 'complete';
  };
}

interface LegionUpdateTasksResult {
  success: boolean;
  newProgress: {
    completed: number;
    total: number;
  };
  warnings: string[];
  autoFixed: string[];
}
```

**è¡Œä¸ºè¡¥å……**ï¼š
- `completeTask` / `setCurrentTask` è‹¥åŒæ—¶æä¾› `taskDescription` ä¸ `taskIndex`ï¼Œä¼˜å…ˆä½¿ç”¨ `taskDescription` è¿›è¡Œç¨³å®šå®šä½ï¼›`taskIndex` ä»…ä½œä¸ºå…œåº•ã€‚
- å½“äººç±»æ‰‹åŠ¨è°ƒæ•´ä»»åŠ¡é¡ºåºæ—¶ï¼ŒMCP ä»¥â€œæè¿°æœ€è¿‘ä¸€æ¬¡å‡ºç°çš„ä½ç½®â€ä¸ºå‡†ï¼Œé¿å… index æ¼‚ç§»å¯¼è‡´è¯¯æ›´æ–°ã€‚

#### 4. ä»»åŠ¡ç®¡ç†å·¥å…·

##### `legion_switch_task`

åˆ‡æ¢å½“å‰ä»»åŠ¡ã€‚

```typescript
interface LegionSwitchTaskParams {
  taskId: string;            // ç›®æ ‡ä»»åŠ¡ id
}

interface LegionSwitchTaskResult {
  success: boolean;
  previousTask: string | null;
  currentTask: string;
  taskStatus: {
    phase: string;
    progress: string;
  };
}
```

##### `legion_archive_task`

å½’æ¡£å·²å®Œæˆçš„ä»»åŠ¡ã€‚

```typescript
interface LegionArchiveTaskParams {
  taskId: string;
}

interface LegionArchiveTaskResult {
  success: boolean;
  archivedPath: string;
}
```

### Schema æ ¡éªŒä¸è‡ªåŠ¨ä¿®å¤

#### æ ¡éªŒè§„åˆ™

| è§„åˆ™ | ä¸¥é‡ç¨‹åº¦ | å¤„ç†æ–¹å¼ |
|------|----------|----------|
| ç¼ºå°‘å¿…éœ€ section | Error | è‡ªåŠ¨æ·»åŠ ç©º section |
| Section é¡ºåºé”™è¯¯ | Warning | æç¤ºä½†ä¸ä¿®æ”¹ |
| ä»»åŠ¡æ ¼å¼ä¸æ­£ç¡® | Error | å°è¯•è§£æå¹¶é‡æ–°æ ¼å¼åŒ– |
| ç¼ºå°‘éªŒæ”¶æ ‡å‡† | Warning | æç¤ºè¡¥å…… |
| çŠ¶æ€æ ‡è®°ä¸ä¸€è‡´ | Error | æ ¹æ® checkbox è‡ªåŠ¨è®¡ç®— |
| æ—¥æœŸæ ¼å¼é”™è¯¯ | Warning | å°è¯•è§£æå¹¶æ ‡å‡†åŒ– |

#### è‡ªåŠ¨ä¿®å¤ç¤ºä¾‹

**è¾“å…¥ï¼ˆæ ¼å¼é”™è¯¯ï¼‰**ï¼š
```markdown
## é˜¶æ®µ 1
- [x] å®Œæˆä»»åŠ¡1
- [ ] æœªå®Œæˆä»»åŠ¡2
```

**è¾“å‡ºï¼ˆä¿®å¤åï¼‰**ï¼š
```markdown
## é˜¶æ®µ 1: æœªå‘½åé˜¶æ®µ ğŸŸ¡ IN PROGRESS

- [x] å®Œæˆä»»åŠ¡1 | éªŒæ”¶: (å¾…è¡¥å……)
- [ ] æœªå®Œæˆä»»åŠ¡2 | éªŒæ”¶: (å¾…è¡¥å……) â† CURRENT
```

**è¿”å›çš„ warnings**ï¼š
```json
{
  "warnings": [
    "é˜¶æ®µç¼ºå°‘åç§°ï¼Œå·²æ·»åŠ å ä½ç¬¦",
    "ä»»åŠ¡ç¼ºå°‘éªŒæ”¶æ ‡å‡†ï¼Œå·²æ·»åŠ å ä½ç¬¦"
  ],
  "autoFixed": [
    "è‡ªåŠ¨è®¡ç®—é˜¶æ®µçŠ¶æ€: IN PROGRESS",
    "è‡ªåŠ¨æ ‡è®°å½“å‰ä»»åŠ¡"
  ]
}
```

---

## Skill è®¾è®¡

### æ¦‚è¿°

LegionMind Skill æ˜¯æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ï¼š
1. æ•™ä¼š Agent ä½•æ—¶åˆ›å»º/æ›´æ–°è®°å½•
2. æŒ‡å¯¼ Agent å¦‚ä½•ä»è®°å½•ä¸­æ¢å¤ä¸Šä¸‹æ–‡
3. æä¾›æœ€ä½³å®è·µå’Œç¤ºä¾‹

### æ–‡ä»¶ç»“æ„

```
.claude/skills/legionmind/
â”œâ”€â”€ SKILL.md                 # ä¸»æ–‡ä»¶ï¼ˆ<500 è¡Œï¼‰
â”œâ”€â”€ SCHEMA.md                # Schema è¯¦ç»†è¯´æ˜
â””â”€â”€ EXAMPLES.md              # å®Œæ•´ç¤ºä¾‹
```

### SKILL.md å†…å®¹å¤§çº²

```markdown
# LegionMind - è·¨ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†

## è¿™æ˜¯ä»€ä¹ˆ

LegionMind å¸®åŠ©ä½ åœ¨å¤šæ¬¡ä¼šè¯ä¹‹é—´ä¿æŒå·¥ä½œä¸Šä¸‹æ–‡ã€‚å½“ä½ ï¼š
- å¼€å§‹ä¸€ä¸ªæ–°çš„å¤æ‚ä»»åŠ¡
- ä¼šè¯å³å°†é‡ç½®
- éœ€è¦åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡
- æƒ³è¦è®°å½•é‡è¦å†³ç­–

éƒ½åº”è¯¥ä½¿ç”¨ LegionMindã€‚

## å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰

å½“åœ¨æ–°ç›®å½•å¼€å§‹å·¥ä½œæ—¶ï¼š
1. è°ƒç”¨ `legion_init` åˆå§‹åŒ– .legion ç›®å½•
2. è°ƒç”¨ `legion_create_task` åˆ›å»ºä»»åŠ¡

### 2. æ¢å¤ä¸Šä¸‹æ–‡ï¼ˆä¼šè¯å¼€å§‹æ—¶ï¼‰

å½“å¼€å§‹æ–°ä¼šè¯æˆ–æ¥æ‰‹ä»»åŠ¡æ—¶ï¼š
1. è°ƒç”¨ `legion_get_status` æŸ¥çœ‹å½“å‰çŠ¶æ€
2. å¦‚æœ `currentTask = null`ï¼Œå¿…é¡»æé†’ç”¨æˆ·å½“å‰æ— æ´»è·ƒä»»åŠ¡ï¼Œå¹¶è¯¢é—®æ˜¯å¦åˆ›å»ºæˆ–åˆ‡æ¢ä»»åŠ¡
3. å¦‚æœå­˜åœ¨æ´»è·ƒä»»åŠ¡ï¼Œè°ƒç”¨ `legion_read_context` è¯»å–å®Œæ•´ä¸Šä¸‹æ–‡
4. åœ¨å¼€å§‹å®ç°å‰ï¼Œå¿…é¡»è¾“å‡º 1-2 è¡Œâ€œå¿«é€Ÿæ¢å¤æ‘˜è¦â€ï¼ˆå½“å‰é˜¶æ®µ / å½“å‰ä»»åŠ¡ / ä¸‹ä¸€æ­¥ï¼‰
5. æ ¹æ® "å¿«é€Ÿäº¤æ¥" éƒ¨åˆ†ç»§ç»­å·¥ä½œ

### 3. è®°å½•è¿›å±•ï¼ˆå·¥ä½œè¿‡ç¨‹ä¸­ï¼‰

å®Œæˆé‡è¦å·¥ä½œåï¼š
1. è°ƒç”¨ `legion_update_tasks` æ ‡è®°å®Œæˆçš„ä»»åŠ¡
2. è°ƒç”¨ `legion_update_context` æ›´æ–°è¿›å±•å’Œå†³ç­–

### 4. ä¿å­˜çŠ¶æ€ï¼ˆä¼šè¯ç»“æŸå‰ï¼‰

ä¼šè¯å³å°†ç»“æŸæ—¶ï¼š
1. ç¡®ä¿æ‰€æœ‰å®Œæˆçš„ä»»åŠ¡å·²æ ‡è®°
2. æ›´æ–° context.md çš„ "å¿«é€Ÿäº¤æ¥" éƒ¨åˆ†
3. è®°å½•ä»»ä½•æœªå®Œæˆçš„å·¥ä½œå’Œé˜»å¡é¡¹

## ä¸‰æ–‡ä»¶ç»“æ„

### plan.md - ä»»åŠ¡è®¡åˆ’
- **ç”¨é€”**ï¼šè®©äººæˆ– Agent å¿«é€Ÿç†è§£ä»»åŠ¡å…¨è²Œ
- **æ›´æ–°é¢‘ç‡**ï¼šä½ï¼ˆè®¡åˆ’å˜æ›´æ—¶ï¼‰
- **æ ¸å¿ƒå†…å®¹**ï¼šç›®æ ‡ã€è¦ç‚¹ã€èŒƒå›´ã€é˜¶æ®µæ¦‚è§ˆ

### context.md - å·¥ä½œä¸Šä¸‹æ–‡
- **ç”¨é€”**ï¼šå·¥ä½œæ—¥å¿—å’Œäº¤æ¥æ–‡æ¡£
- **æ›´æ–°é¢‘ç‡**ï¼šé«˜ï¼ˆæ¯æ¬¡é‡è¦è¿›å±•ï¼‰
- **æ ¸å¿ƒå†…å®¹**ï¼šè¿›å±•ã€å†³ç­–ã€å…³é”®æ–‡ä»¶ã€å¿«é€Ÿäº¤æ¥

### tasks.md - ä»»åŠ¡æ¸…å•
- **ç”¨é€”**ï¼šè¿›åº¦è·Ÿè¸ª
- **æ›´æ–°é¢‘ç‡**ï¼šé«˜ï¼ˆå®Œæˆä»»åŠ¡æ—¶ï¼‰
- **æ ¸å¿ƒå†…å®¹**ï¼šé˜¶æ®µã€ä»»åŠ¡åˆ—è¡¨ã€éªŒæ”¶æ ‡å‡†

## ä½•æ—¶æ›´æ–°

| äº‹ä»¶ | æ›´æ–°ä»€ä¹ˆ |
|------|----------|
| å®Œæˆä¸€ä¸ªä»»åŠ¡ | tasks.mdï¼ˆæ ‡è®°å®Œæˆï¼‰ã€context.mdï¼ˆæ·»åŠ åˆ°å·²å®Œæˆï¼‰ |
| åšå‡ºé‡è¦å†³ç­– | context.mdï¼ˆæ·»åŠ å†³ç­–è®°å½•ï¼‰ |
| å‘ç°æ–°ä»»åŠ¡ | tasks.mdï¼ˆæ·»åŠ åˆ°"å‘ç°çš„æ–°ä»»åŠ¡"ï¼‰ |
| é‡åˆ°é˜»å¡ | context.mdï¼ˆæ·»åŠ åˆ°é˜»å¡é¡¹ï¼‰ |
| ä¼šè¯å³å°†ç»“æŸ | context.mdï¼ˆæ›´æ–°å¿«é€Ÿäº¤æ¥ï¼‰ |
| è®¡åˆ’å˜æ›´ | plan.mdï¼ˆæ›´æ–°ç›¸å…³éƒ¨åˆ†ï¼‰ |

## MCP å·¥å…·å‚è€ƒ

ï¼ˆç®€è¦åˆ—å‡ºæ‰€æœ‰å·¥å…·åŠå…¶ç”¨é€”ï¼‰

## å¸¸è§é—®é¢˜

### Q: ä»€ä¹ˆæ—¶å€™åº”è¯¥åˆ›å»ºæ–°ä»»åŠ¡ï¼Ÿ
A: å½“å¼€å§‹ä¸€ä¸ªé¢„è®¡éœ€è¦å¤šæ¬¡ä¼šè¯æˆ–æœ‰å¤šä¸ªæ­¥éª¤çš„å·¥ä½œæ—¶ã€‚

### Q: å¦‚æœäººç±»æ‰‹åŠ¨ç¼–è¾‘äº†æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿ
A: MCP å·¥å…·ä¼šå°è¯•è§£æå¹¶è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜ï¼ŒåŒæ—¶è¿”å›è­¦å‘Šã€‚

### Q: å¦‚ä½•å¤„ç†å¤šä¸ªå¹¶è¡Œä»»åŠ¡ï¼Ÿ
A: ä½¿ç”¨ `legion_switch_task` åˆ‡æ¢å½“å‰æ´»è·ƒä»»åŠ¡ã€‚æ¯ä¸ªä»»åŠ¡ç‹¬ç«‹ç»´æŠ¤è‡ªå·±çš„ä¸‰æ–‡ä»¶ã€‚

è¯¦ç»† Schema è¯·å‚è€ƒ [SCHEMA.md](./SCHEMA.md)
å®Œæ•´ç¤ºä¾‹è¯·å‚è€ƒ [EXAMPLES.md](./EXAMPLES.md)
```

### æŠ€èƒ½æ¿€æ´»è§„åˆ™

åœ¨ `.claude/skills/skill-rules.json` ä¸­æ·»åŠ ï¼š

```json
{
  "legionmind": {
    "keywords": [
      "legion",
      "ä¸Šä¸‹æ–‡",
      "context",
      "è·¨ä¼šè¯",
      "cross-session",
      "ä»»åŠ¡è®°å½•",
      "å·¥ä½œæ—¥å¿—"
    ],
    "intentPatterns": [
      "è®°å½•.*è¿›å±•",
      "ä¿å­˜.*çŠ¶æ€",
      "æ¢å¤.*ä¸Šä¸‹æ–‡",
      "ç»§ç»­.*ä»»åŠ¡",
      "å¼€å§‹.*æ–°ä»»åŠ¡"
    ],
    "filePatterns": [
      ".legion/**/*"
    ],
    "suggestWhen": [
      "session_start_with_legion_dir",
      "complex_task_detected",
      "context_reset_imminent"
    ]
  }
}
```

---

## Hook è®¾è®¡

### æ¦‚è¿°

LegionMind Hook æä¾›è½»é‡çº§æé†’ï¼Œä¸è‡ªåŠ¨å†™å…¥ã€‚

### Hook å®šä¹‰

```bash
# .claude/hooks/legion-reminder.sh

#!/bin/bash

# Hook ç±»å‹: UserPromptSubmit
# è§¦å‘æ¡ä»¶: æ£€æµ‹åˆ°å¯èƒ½çš„ session ç»“æŸä¿¡å·

# æ£€æŸ¥æ˜¯å¦å­˜åœ¨ .legion ç›®å½•
if [ -d ".legion" ]; then
  # æ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦åŒ…å«ç»“æŸä¿¡å·
  if echo "$USER_PROMPT" | grep -qiE "(ç»“æŸ|å®Œæˆ|done|finish|bye|exit|reset|compact)"; then
    echo "ğŸ’¡ æé†’: æ£€æµ‹åˆ° .legion ç›®å½•ã€‚åœ¨ç»“æŸå‰ï¼Œè€ƒè™‘ï¼š"
    echo "   1. æ›´æ–° tasks.md ä¸­å·²å®Œæˆçš„ä»»åŠ¡"
    echo "   2. æ›´æ–° context.md çš„å¿«é€Ÿäº¤æ¥éƒ¨åˆ†"
    echo "   3. è®°å½•ä»»ä½•é˜»å¡é¡¹æˆ–å¾…åŠäº‹é¡¹"
  fi
fi
```

### Hook é…ç½®

åœ¨ `.claude/settings.json` ä¸­ï¼š

```json
{
  "hooks": {
    "UserPromptSubmit": [
      {
        "script": ".claude/hooks/legion-reminder.sh",
        "enabled": true
      }
    ]
  }
}
```

### Hook è¡Œä¸º

| è§¦å‘æ¡ä»¶ | è¡Œä¸º |
|----------|------|
| å­˜åœ¨ .legion ç›®å½• + ç”¨æˆ·è¾“å…¥åŒ…å«ç»“æŸä¿¡å· | è¾“å‡ºæé†’æ¶ˆæ¯ |
| ä¸å­˜åœ¨ .legion ç›®å½• | é™é»˜è·³è¿‡ |
| ç”¨æˆ·è¾“å…¥ä¸åŒ…å«ç»“æŸä¿¡å· | é™é»˜è·³è¿‡ |

---

## å®æ–½è®¡åˆ’

### é˜¶æ®µ 1: Skill æ ¸å¿ƒ (ä¼˜å…ˆçº§æœ€é«˜)

| ä»»åŠ¡ | æè¿° | å·¥ä½œé‡ |
|------|------|--------|
| 1.1 | åˆ›å»º SKILL.md ä¸»æ–‡ä»¶ | M |
| 1.2 | åˆ›å»º SCHEMA.md è¯¦ç»†è¯´æ˜ | M |
| 1.3 | åˆ›å»º EXAMPLES.md å®Œæ•´ç¤ºä¾‹ | S |
| 1.4 | æ·»åŠ æŠ€èƒ½æ¿€æ´»è§„åˆ™ | S |

**äº¤ä»˜ç‰©**ï¼šå®Œæ•´çš„ Skill æ–‡æ¡£ï¼ŒAgent å¯ä»¥æ ¹æ®æ–‡æ¡£æ‰‹åŠ¨ç»´æŠ¤ .legion æ–‡ä»¶

### é˜¶æ®µ 2: MCP Server

| ä»»åŠ¡ | æè¿° | å·¥ä½œé‡ |
|------|------|--------|
| 2.1 | æ­å»º MCP Server æ¡†æ¶ | M |
| 2.2 | å®ç°åˆå§‹åŒ–å·¥å…· (init, create_task) | M |
| 2.3 | å®ç°æŸ¥è¯¢å·¥å…· (get_status, list_tasks, read_context) | M |
| 2.4 | å®ç°æ›´æ–°å·¥å…· (update_plan, update_context, update_tasks) | L |
| 2.5 | å®ç° Schema æ ¡éªŒå’Œè‡ªåŠ¨ä¿®å¤ | L |
| 2.6 | å®ç°ä»»åŠ¡ç®¡ç†å·¥å…· (switch_task, archive_task) | S |

**äº¤ä»˜ç‰©**ï¼šåŠŸèƒ½å®Œæ•´çš„ MCP Serverï¼Œæä¾›æ ¼å¼æ ¡éªŒå’Œæ ‡å‡†åŒ–æ“ä½œ

### é˜¶æ®µ 3: Hook

| ä»»åŠ¡ | æè¿° | å·¥ä½œé‡ |
|------|------|--------|
| 3.1 | åˆ›å»º legion-reminder.sh | S |
| 3.2 | é…ç½® Hook æ¿€æ´»è§„åˆ™ | S |
| 3.3 | æµ‹è¯• Hook è§¦å‘æ¡ä»¶ | S |

**äº¤ä»˜ç‰©**ï¼šè½»é‡çº§æé†’ Hook

### é˜¶æ®µ 4: é›†æˆæµ‹è¯•

| ä»»åŠ¡ | æè¿° | å·¥ä½œé‡ |
|------|------|--------|
| 4.1 | ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯• | M |
| 4.2 | è¾¹ç•Œæƒ…å†µæµ‹è¯•ï¼ˆæ ¼å¼é”™è¯¯ã€å¹¶å‘ç­‰ï¼‰ | M |
| 4.3 | ç¼–å†™ä½¿ç”¨æ–‡æ¡£ | S |

---

## æˆåŠŸæŒ‡æ ‡

### æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹å¼ |
|------|------|----------|
| ä¸Šä¸‹æ–‡æ¢å¤æ—¶é—´ | < 30 ç§’ | ä»è¯»å– .legion åˆ°ç†è§£ä»»åŠ¡çŠ¶æ€ |
| æ ¼å¼ä¸€è‡´æ€§ | > 95% | è‡ªåŠ¨æ ¡éªŒé€šè¿‡ç‡ |
| äººç±»å¯è¯»æ€§ | 100% | éæŠ€æœ¯äººå‘˜èƒ½ç†è§£æ–‡ä»¶å†…å®¹ |

### ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| é¦–æ¬¡ä½¿ç”¨å­¦ä¹ æ›²çº¿ | < 5 åˆ†é’Ÿç†è§£åŸºæœ¬æ¦‚å¿µ |
| æ—¥å¸¸ä½¿ç”¨å¼€é”€ | æ¯æ¬¡ä¼šè¯ < 2 åˆ†é’Ÿç»´æŠ¤æ—¶é—´ |
| é”™è¯¯æ¢å¤ | æ ¼å¼é”™è¯¯è‡ªåŠ¨ä¿®å¤ï¼Œæ— éœ€äººå·¥å¹²é¢„ |

---

## é™„å½•

### A. ä»»åŠ¡åå‘½åè§„èŒƒ

```
æ˜¾ç¤ºåï¼ˆä»»åŠ¡åï¼‰ï¼š
  - å…è®¸ä¸­æ–‡ã€è‹±æ–‡ã€ç©ºæ ¼ã€å¸¸è§æ ‡ç‚¹
  - å»ºè®®é•¿åº¦ 2-80 å­—ç¬¦

task idï¼ˆç›®å½•åï¼‰ï¼š
  - ç”± MCP è‡ªåŠ¨ç”Ÿæˆå¹¶ä¿æŒç¨³å®š
  - ä¼˜å…ˆ slugify æ˜¾ç¤ºåï¼›å†²çªæˆ–ä¸å¯ç”¨æ—¶ä½¿ç”¨ `task-{shortHash}`

âœ… æ­£ç¡®ç¤ºä¾‹ï¼š
  - å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—
  - æ€§èƒ½é—®é¢˜æ’æŸ¥ï¼ˆæ”¯ä»˜é“¾è·¯ï¼‰
  - Refactor DB layer

âŒ é”™è¯¯ç¤ºä¾‹ï¼š
  - (æ— å¼ºåˆ¶æ ¼å¼é”™è¯¯ï¼›ä»…ä¸å»ºè®®ä½¿ç”¨çº¯ç¬¦å·ä½œä¸ºæ˜¾ç¤ºå)
```

### B. æ—¥æœŸæ—¶é—´æ ¼å¼

```
æ—¥æœŸï¼šYYYY-MM-DD
æ—¶é—´ï¼šHH:mm
å®Œæ•´ï¼šYYYY-MM-DD HH:mm

ç¤ºä¾‹ï¼š
  - 2025-12-12
  - 14:30
  - 2025-12-12 14:30
```

### C. çŠ¶æ€æšä¸¾

```
ä»»åŠ¡çŠ¶æ€ï¼š
  - active     # æ´»è·ƒä»»åŠ¡
  - paused     # æš‚åœä»»åŠ¡
  - completed  # å·²å®Œæˆ
  - archived   # å·²å½’æ¡£

é˜¶æ®µçŠ¶æ€ï¼š
  - not_started  # æœªå¼€å§‹
  - in_progress  # è¿›è¡Œä¸­
  - complete     # å·²å®Œæˆ

æ–‡ä»¶çŠ¶æ€ï¼š
  - completed    # å·²å®Œæˆ
  - in_progress  # è¿›è¡Œä¸­
  - pending      # å¾…å¤„ç†
  - deleted      # å·²åˆ é™¤
```

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0.0*
*åˆ›å»ºæ—¥æœŸ: 2025-12-12*
*æœ€åæ›´æ–°: 2025-12-12*
